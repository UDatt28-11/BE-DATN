{
    "openapi": "3.0.0",
    "info": {
        "title": "BookHomeStay API Docs",
        "description": "API documentation for BookHomeStay — manage homestays, bookings, and users.",
        "version": "1.0.0"
    },
    "paths": {
        "/api/admin/login": {
            "post": {
                "tags": [
                    "Admin Auth"
                ],
                "summary": "Login admin",
                "description": "Authenticate admin and return a bearer token",
                "operationId": "02064f557af8baf1c24fd21c09b689f3",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "example": "admin@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "secret123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful login",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - invalid credentials"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/admin/logout": {
            "post": {
                "tags": [
                    "Admin Auth"
                ],
                "summary": "Logout admin",
                "description": "Invalidate current admin access token",
                "operationId": "18687458536b64e1e1c3725706529bb2",
                "responses": {
                    "200": {
                        "description": "Logged out",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/{role}/google/redirect": {
            "get": {
                "tags": [
                    "Google Login"
                ],
                "summary": "Lấy URL đăng nhập Google (tự động redirect sang Google)",
                "description": "Trả về URL mà frontend dùng để redirect người dùng sang trang đăng nhập Google. Role có thể là user, staff hoặc admin.",
                "operationId": "d6a24013533955bf075ef7ec1f9f05f4",
                "parameters": [
                    {
                        "name": "role",
                        "in": "path",
                        "description": "Vai trò của người dùng (user, staff, admin)",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "user",
                                "staff",
                                "admin"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "URL redirect thành công",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "url": {
                                            "type": "string",
                                            "example": "https://accounts.google.com/o/oauth2/auth?..."
                                        },
                                        "role": {
                                            "type": "string",
                                            "example": "user"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Role không hợp lệ"
                    }
                }
            }
        },
        "/api/{role}/google/callback": {
            "get": {
                "tags": [
                    "Google Login"
                ],
                "summary": "Xử lý callback từ Google sau khi đăng nhập",
                "description": "Sau khi người dùng đăng nhập Google, Google sẽ redirect về URL này. Hệ thống sẽ tự động tạo tài khoản nếu chưa có, và trả về token đăng nhập.",
                "operationId": "eaddd784e4d989f51053d994aeb74fac",
                "parameters": [
                    {
                        "name": "role",
                        "in": "path",
                        "description": "Vai trò của người dùng (user, staff, admin)",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": [
                                "user",
                                "staff",
                                "admin"
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Đăng nhập thành công",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "status": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Đăng nhập Google thành công!"
                                        },
                                        "user": {
                                            "properties": {
                                                "id": {
                                                    "type": "integer",
                                                    "example": 1
                                                },
                                                "name": {
                                                    "type": "string",
                                                    "example": "Nguyễn Văn A"
                                                },
                                                "email": {
                                                    "type": "string",
                                                    "example": "vana@gmail.com"
                                                },
                                                "role": {
                                                    "type": "string",
                                                    "example": "user"
                                                },
                                                "avatar": {
                                                    "type": "string",
                                                    "example": "https://lh3.googleusercontent.com/a/..."
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string",
                                            "example": "2|Kq0d8gZyR3YhF..."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Role không hợp lệ"
                    },
                    "500": {
                        "description": "Lỗi hệ thống hoặc lỗi xác thực Google"
                    }
                }
            }
        },
        "/api/staff/register": {
            "post": {
                "tags": [
                    "Staff Auth"
                ],
                "summary": "Register staff",
                "description": "Đăng ký tài khoản nhân viên",
                "operationId": "1c5ee8a1305d2747ef52d477d4cc072b",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "full_name": {
                                        "type": "string",
                                        "example": "Nguyen Van B"
                                    },
                                    "email": {
                                        "type": "string",
                                        "example": "staff@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "secret123"
                                    },
                                    "password_confirmation": {
                                        "type": "string",
                                        "example": "secret123"
                                    },
                                    "phone_number": {
                                        "type": "string",
                                        "example": "0912345678"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Staff registered",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/staff/login": {
            "post": {
                "tags": [
                    "Staff Auth"
                ],
                "summary": "Login staff",
                "description": "Authenticate staff and return a bearer token",
                "operationId": "c21cef73761ad984e37cc37202d2d264",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "example": "staff@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "secret123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful login",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - invalid credentials"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/staff/logout": {
            "post": {
                "tags": [
                    "Staff Auth"
                ],
                "summary": "Logout staff",
                "description": "Invalidate current staff access token",
                "operationId": "8872473e20787e41155f4ad616517fa5",
                "responses": {
                    "200": {
                        "description": "Logged out",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/user/register": {
            "post": {
                "tags": [
                    "User Auth"
                ],
                "summary": "Register a new user",
                "operationId": "797719db7fc6fd52f9b242f4aae9fbc0",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "full_name": {
                                        "type": "string",
                                        "example": "Nguyen Van A"
                                    },
                                    "email": {
                                        "type": "string",
                                        "example": "user@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "secret123"
                                    },
                                    "password_confirmation": {
                                        "type": "string",
                                        "example": "secret123"
                                    },
                                    "phone_number": {
                                        "type": "string",
                                        "example": "0912345678"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "User registered",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/user/login": {
            "post": {
                "tags": [
                    "User Auth"
                ],
                "summary": "User login",
                "operationId": "2f17cb8a1efc5b9a7c772afe77354b8d",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "example": "user@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "secret123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful login",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        },
                                        "user": {
                                            "type": "object"
                                        },
                                        "token": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - invalid credentials"
                    },
                    "422": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/user/logout": {
            "post": {
                "tags": [
                    "User Auth"
                ],
                "summary": "Logout user",
                "description": "Invalidate current access token",
                "operationId": "5f31405506572410baee3da0e578e588",
                "responses": {
                    "200": {
                        "description": "Logged out",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/user/forgot-password": {
            "post": {
                "tags": [
                    "User Auth"
                ],
                "summary": "Gửi email chứa liên kết đặt lại mật khẩu",
                "description": "Người dùng nhập email, hệ thống sẽ gửi một liên kết đặt lại mật khẩu có chứa token hợp lệ qua email.",
                "operationId": "3bf0ede80ef09bc9d356e6563e667022",
                "parameters": [
                    {
                        "name": "Accept",
                        "in": "header",
                        "description": "Định dạng phản hồi, luôn là application/json",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "default": "application/json"
                        }
                    }
                ],
                "requestBody": {
                    "description": "Email người dùng cần khôi phục mật khẩu",
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "user@example.com"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Email khôi phục mật khẩu đã được gửi thành công."
                    },
                    "422": {
                        "description": "Email không tồn tại hoặc không hợp lệ."
                    },
                    "500": {
                        "description": "Lỗi hệ thống hoặc lỗi khi gửi email."
                    }
                }
            }
        },
        "/api/user/reset-password": {
            "post": {
                "tags": [
                    "User Auth"
                ],
                "summary": "Đặt lại mật khẩu bằng token",
                "description": "Người dùng gửi token + email + mật khẩu mới để đặt lại mật khẩu.",
                "operationId": "71c0e3259bb3f4d4bafa8265740fe823",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "token",
                                    "email",
                                    "password",
                                    "password_confirmation"
                                ],
                                "properties": {
                                    "token": {
                                        "type": "string",
                                        "example": "abc123"
                                    },
                                    "email": {
                                        "type": "string",
                                        "example": "user@example.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "newpassword"
                                    },
                                    "password_confirmation": {
                                        "type": "string",
                                        "example": "newpassword"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Đặt lại mật khẩu thành công."
                    },
                    "400": {
                        "description": "Token không hợp lệ hoặc đã hết hạn."
                    },
                    "422": {
                        "description": "Dữ liệu không hợp lệ."
                    }
                }
            }
        }
    },
    "tags": [
        {
            "name": "Google Login",
            "description": "Đăng nhập và đăng ký bằng tài khoản Google cho các vai trò khác nhau (user, staff, admin)"
        },
        {
            "name": "Admin Auth",
            "description": "Admin Auth"
        },
        {
            "name": "Staff Auth",
            "description": "Staff Auth"
        },
        {
            "name": "User Auth",
            "description": "User Auth"
        }
    ],
    "components": {
        "securitySchemes": {
            "sanctum": {
                "type": "apiKey",
                "description": "Nhập token dạng: Bearer {token}",
                "name": "Authorization",
                "in": "header"
            }
        }
    },
    "security": [
        {
            "sanctum": []
        }
    ]
}